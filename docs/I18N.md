# Multilingual Support Documentation

## Overview

This blog now supports full multilingual content in English (default) and Spanish. The implementation uses a custom i18n solution built on top of Astro's static site generation.

## Supported Languages

- **English (en)**: Default language, served at root paths (`/`, `/blog/...`, `/tags/...`)
- **Spanish (es)**: Served at `/es/` prefixed paths (`/es/`, `/es/blog/...`, `/es/tags/...`)

## Architecture

### Directory Structure

```
src/
├── i18n/
│   ├── config.ts           # Language configuration
│   ├── utils.ts            # i18n utility functions
│   └── translations/
│       ├── en.json         # English translations
│       └── es.json         # Spanish translations
├── pages/
│   ├── index.astro         # English homepage
│   ├── blog/[slug].astro   # English blog posts
│   ├── tags/               # English tags pages
│   └── es/                 # Spanish pages
│       ├── index.astro
│       ├── blog/[slug].astro
│       └── tags/
└── content/
    └── blog/               # All blog posts with language field
```

### Key Files

#### `src/i18n/config.ts`
Defines supported languages and configuration:
- Language codes and labels
- Default language setting
- Language validation utilities

#### `src/i18n/utils.ts`
Core i18n utilities:
- `useTranslations(lang)`: Get translation function for a language
- `getLangFromUrl(url)`: Extract language from URL
- `getLocalizedPath(path, lang)`: Create language-specific URLs
- `formatDate(date, lang)`: Format dates in the correct locale

#### `src/i18n/translations/[lang].json`
Translation dictionaries organized by category:
- `site`: Site metadata
- `nav`: Navigation items
- `hero`: Homepage hero section
- `post`: Blog post UI elements
- `footer`: Footer content
- `tags`: Tags pages

## Content Structure

### Blog Posts

All blog posts include a `language` field in their frontmatter:

```markdown
---
title: "Your Post Title"
description: "Post description"
author: "author-id"
pubDate: 2025-01-04
heroImage: "/images/hero.jpg"
tags: ["tag1", "tag2"]
draft: false
language: "en"  # or "es"
---

Your content here...
```

### Content Schema

The content schema in `src/content/config.ts` includes language validation:

```typescript
language: z.enum(['en', 'es']).default('en')
```

## Usage

### Creating Content

#### Via CMS (Decap CMS)

1. Navigate to `/admin`
2. Create a new blog post
3. Select the language from the dropdown: "en" or "es"
4. Fill in content in the selected language
5. Publish

#### Manually

1. Create a markdown file in `src/content/blog/`
2. Add frontmatter with `language: "en"` or `language: "es"`
3. Write content in the selected language

### Adding New Languages

To add a new language (e.g., French):

1. **Update config** (`src/i18n/config.ts`):
```typescript
export const languages = {
  en: 'English',
  es: 'Español',
  fr: 'Français',  // Add new language
} as const;
```

2. **Create translations** (`src/i18n/translations/fr.json`):
```json
{
  "site": {
    "title": "Blog Tangara Studio",
    "description": "..."
  },
  // ... other translations
}
```

3. **Update content schema** (`src/content/config.ts`):
```typescript
language: z.enum(['en', 'es', 'fr']).default('en')
```

4. **Create locale pages** (`src/pages/fr/...`):
- Copy structure from `src/pages/es/`
- Update language references to 'fr'

5. **Update Astro config** (`astro.config.mjs`):
```javascript
i18n: {
  defaultLocale: 'en',
  locales: ['en', 'es', 'fr'],
  // ...
}
```

6. **Update CMS config** (`public/admin/config.yml`):
```yaml
- { label: "Language", name: "language", widget: "select", options: ["en", "es", "fr"], default: "en" }
```

### Adding New Translations

To add a new translation string:

1. Add to English translations (`src/i18n/translations/en.json`):
```json
{
  "newSection": {
    "newKey": "English text"
  }
}
```

2. Add to all other language files with translated text

3. Use in components:
```astro
---
import { useTranslations, getLangFromUrl } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<p>{t('newSection.newKey')}</p>
```

## SEO Features

### Alternate Language Tags

Every page includes proper hreflang tags:
```html
<link rel="alternate" hreflang="en" href="https://blog.tangara.studio/" />
<link rel="alternate" hreflang="es" href="https://blog.tangara.studio/es/" />
<link rel="alternate" hreflang="x-default" href="https://blog.tangara.studio/" />
```

### Locale-Specific Metadata

- `<html lang="...">` attribute
- `og:locale` meta tag (e.g., `en_US`, `es_ES`)
- Language-specific canonical URLs

### Sitemap

The sitemap includes all language versions of pages for proper indexing.

## Components

### LanguageSwitcher

The language switcher component (`src/components/LanguageSwitcher.astro`) provides:
- Visual indication of current language
- One-click language switching
- Maintains current path in new language

Usage:
```astro
<LanguageSwitcher />
```

## Best Practices

1. **Always specify language**: Every blog post should have a `language` field
2. **Consistent translations**: Keep translation keys consistent across languages
3. **Test both languages**: Verify content displays correctly in both languages
4. **SEO considerations**: Ensure proper hreflang and locale tags
5. **Content parity**: Try to maintain similar content availability in both languages

## Troubleshooting

### Posts not showing in correct language

- Check the `language` field in the post frontmatter
- Verify the language value is either "en" or "es"
- Clear build cache: `npm run clean && npm run build`

### Language switcher not working

- Verify URL structure matches expected pattern
- Check `getLangFromUrl` utility is being used
- Ensure paths are properly prefixed for Spanish (`/es/`)

### Missing translations

- Check console for translation key warnings
- Verify key exists in all translation files
- Ensure nested keys are properly accessed with dot notation

## Performance

- Static site generation ensures zero runtime overhead
- Language detection happens at build time
- All translations are bundled efficiently
- No client-side JavaScript required for i18n

## Future Enhancements

Potential improvements:
- Browser language detection and automatic redirect
- Language preference persistence via cookies
- Translation management UI
- Additional languages (Portuguese, French, etc.)
- Machine translation integration for draft content
